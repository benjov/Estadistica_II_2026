knitr::opts_chunk$set(echo = TRUE)
#tinytex::install_tinytex()
#installed.packages('foreign')
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("plotly")
#install.packages('car')
library(tidyverse)
library(knitr)
library(foreign)
library(ggplot2)
library(dplyr)
library(plotly)
library(car)
# Small fig.width
include_graphics('Hayashi_p62.png')
# Small fig.width
include_graphics('Nerlove.png')
dataframe <- read.dta("nerlove63.dta")
names(dataframe)
dataframe %>% head()
summary(dataframe)
dataframe$Ltotcost = log(dataframe$totcost)
dataframe$Loutput = log(dataframe$output)
dataframe$Lplabor = log(dataframe$plabor)
dataframe$Lpfuel = log(dataframe$pfuel)
dataframe$Lpkap = log(dataframe$pkap)
dataframe$avgcost = dataframe$totcost/dataframe$output
dataframe %>% head()
fig <- plot_ly(alpha = 0.6)
fig <- fig %>% add_histogram(x = dataframe$plabor, name = 'plabor')
#fig <- fig %>% add_histogram(x = ~dataframe$pkap, name = 'pkap')
#fig <- fig %>% layout(barmode = "overlay")
fig
p <- ggplot(dataframe, aes(totcost)) +
geom_density( fill="#69b3a2", color="#e9ecef", alpha=0.8 ) +
ggtitle("Gr치fica de densidad")
fig <- ggplotly(p)
fig
fig <- plot_ly(data = dataframe, x = ~output, y = ~avgcost,
marker = list(size = 8, color = 'darkred'))
fig <- fig %>% layout(title = 'Costo medio y producto')
fig
#Create the linear regression
Reg_01 = lm(Ltotcost ~ Loutput + Lplabor + Lpfuel + Lpkap, data = dataframe)
summary(Reg_01)
hypothesis <- "Lplabor + Lpfuel + Lpkap = 1"
test <- linearHypothesis(Reg_01, hypothesis)
test
knitr::opts_chunk$set(echo = TRUE)
#tinytex::install_tinytex()
#installed.packages('foreign')
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("plotly")
#install.packages('car')
library(tidyverse)
library(knitr)
library(foreign)
library(ggplot2)
library(dplyr)
library(plotly)
library(car)
# Small fig.width
include_graphics('Hayashi_p62.png')
# Small fig.width
include_graphics('Nerlove.png')
dataframe <- read.dta("nerlove63.dta")
head(dataframe)
names(dataframe)
dataframe %>% head()
summary(dataframe)
dataframe %>% summary()
#summary(dataframe)
dataframe %>% summary()
summary(dataframe)
#dataframe %>% summary()
dataframe$Ltotcost = log(dataframe$totcost)
dataframe$Loutput = log(dataframe$output)
dataframe$Lplabor = log(dataframe$plabor)
dataframe$Lpfuel = log(dataframe$pfuel)
dataframe$Lpkap = log(dataframe$pkap)
dataframe$avgcost = dataframe$totcost/dataframe$output
dataframe %>% head()
fig <- plot_ly(alpha = 0.6)
fig <- fig %>% add_histogram(x = dataframe$plabor, name = 'plabor')
#fig <- fig %>% add_histogram(x = ~dataframe$pkap, name = 'pkap')
#fig <- fig %>% layout(barmode = "overlay")
fig
fig <- plot_ly(alpha = 0.6)
fig <- fig %>% add_histogram(x = dataframe$plabor, name = 'plabor')
fig <- fig %>% add_histogram(x = ~dataframe$pkap, name = 'pkap')
fig <- fig %>% layout(barmode = "overlay")
fig
fig <- plot_ly(alpha = 0.6)
fig <- fig %>% add_histogram(x = dataframe$plabor, name = 'plabor')
#fig <- fig %>% add_histogram(x = ~dataframe$pkap, name = 'pkap')
#fig <- fig %>% layout(barmode = "overlay")
fig
p <- ggplot(dataframe, aes(totcost)) +
geom_density( fill="#69b3a2", color="#e9ecef", alpha=0.8 ) +
ggtitle("Gr치fica de densidad")
fig <- ggplotly(p)
fig
fig <- plot_ly(data = dataframe, x = ~output, y = ~avgcost,
marker = list(size = 8, color = 'darkred'))
fig <- fig %>% layout(title = 'Costo medio y producto')
fig
fig <- plot_ly(data = dataframe, x = ~output, y = ~avgcost,
type = 'scatter',
mode = 'markers',
marker = list(size = 8, color = 'darkred'))
fig <- plot_ly(data = dataframe, x = ~output, y = ~avgcost,
type = 'scatter',
mode = 'markers',
marker = list(size = 8, color = 'darkred'))
fig <- fig %>% layout(title = 'Costo medio y producto')
fig
#Create the linear regression
Reg_01 = lm(Ltotcost ~ Loutput + Lplabor + Lpfuel + Lpkap, data = dataframe)
summary(Reg_01)
y
# 1. Vector y (variable dependiente)
y <- as.matrix(dataframe$Ltotcost)
y
# 1. Vector y (variable dependiente)
y <- as.matrix(dataframe$Ltotcost)
#y
# 2. Matriz X (incluye el intercepto y las variables independientes)
X <- cbind(1,
dataframe$Loutput,
dataframe$Lplabor,
dataframe$Lpfuel,
dataframe$Lpkap)
# Opcionalmente, puedes nombrar las columnas
colnames(X) <- c("Intercept", "Loutput", "Lplabor", "Lpfuel", "Lpkap")
X
# 2. Matriz X (incluye el intercepto y las variables independientes)
X <- cbind(1,
dataframe$Loutput,
dataframe$Lplabor,
dataframe$Lpfuel,
dataframe$Lpkap)
# Opcionalmente, puedes nombrar las columnas
#colnames(X) <- c("Intercept", "Loutput", "Lplabor", "Lpfuel", "Lpkap")
#X
t(X) %*% X
# inv(X'*X)
solve(t(X) %*% X)
# X'*Y
t(X) %*% y
# 3. Estimaci칩n de coeficientes por f칩rmula matricial OLS:
# beta_hat = (X'X)^(-1) X'y
beta_hat <- solve(t(X) %*% X) %*% t(X) %*% y
beta_hat
#Create the linear regression
Reg_01 = lm(Ltotcost ~ Loutput + Lplabor + Lpfuel + Lpkap, data = dataframe)
summary(Reg_01)
hypothesis <- "Lplabor + Lpfuel + Lpkap = 1"
test <- linearHypothesis(Reg_01, hypothesis)
test
y_hat = X %*% beta_hat
# Y predichos
y_hat = X %*% beta_hat
y_hat
#y_hat
```
# Y predichos
y_hat = X %*% beta_hat
#y_hat
e = y - y_hat
Sigma2_hat = (t(e) %*% e)
Sigma2_hat
length(e)
e = y - y_hat
Sigma2_hat = (t(e) %*% e) / (length(e) - 4)
Sigma2_hat
