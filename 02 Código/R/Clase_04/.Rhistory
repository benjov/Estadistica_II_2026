knitr::opts_chunk$set(echo = TRUE)
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("readxl")
#
library(ggplot2)
library(dplyr)
library(readxl)
# Ruta al archivo ZIP
zip_file <- "enigh2016_ns_concentradohogar_csv.zip"
# Lista de archivos dentro del ZIP (puedes revisar el nombre exacto del CSV)
unzip(zip_file, list = TRUE)
# Ruta al archivo ZIP
zip_file <- "enigh2016_ns_concentradohogar_csv.zip"
# Lista de archivos dentro del ZIP (puedes revisar el nombre exacto del CSV)
unzip(zip_file, list = TRUE)
# Leer directamente el CSV (si conoces el nombre del archivo)
concentrado_2016 <- read.csv(unz(zip_file, "concentradohogar.csv"))
# Verificamos
head(concentrado_2016)
dim(concentrado_2016)
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("readxl")
install.packages("Hmisc")
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("readxl")
install.packages("Hmisc")
```
library(Hmisc)
install.packages("Hmisc")
library(Hmisc)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("readxl")
#install.packages("Hmisc")
#Do you want to install from sources the package which needs compilation? (Yes/no/cancel) no
#
library(ggplot2)
library(dplyr)
library(readxl)
library(Hmisc)
# Crear los puntos de corte (deciles)
decil_cortes <- wtd.quantile(datos$ing_cor, weights = datos$factor, probs = seq(0, 1, 0.1))
# Crear los puntos de corte (deciles)
decil_cortes <- wtd.quantile( concentrado_2016$ing_cor,
weights = concentrado_2016$factor,
probs = seq(0, 1, 0.1))
# Asignar decil a cada observación
concentrado_2016 <- concentrado_2016 %>%
mutate(decil = cut(ing_cor, breaks = decil_cortes, include.lowest = TRUE, labels = 1:10))
concentrado_2016[ c( 'folioviv', 'foliohog', 'factor', 'ing_cor', 'decil', 'gasto_mon', 'salud' ) ]
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("readxl")
#install.packages("Hmisc")
#Do you want to install from sources the package which needs compilation? (Yes/no/cancel) no
install.packages(survey)
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("readxl")
#install.packages("Hmisc")
#Do you want to install from sources the package which needs compilation? (Yes/no/cancel) no
install.packages("survey")
library(survey)
# Crear un diseño de encuesta con pesos
diseno <- svydesign(ids = ~1, data = concentrado_2016_SEL, weights = ~factor)
# Seleccionamos diversa información, icluído el gasto trimestral en cuidados de salud
concentrado_2016_SEL <- concentrado_2016[ c( 'folioviv', 'foliohog', 'factor', 'ing_cor', 'decil', 'gasto_mon', 'salud' ) ]
# Crear un diseño de encuesta con pesos
diseno <- svydesign(ids = ~1, data = concentrado_2016_SEL, weights = ~factor)
# Tabla de frecuencias ponderada
svytable(~decil, design = diseno)
# Filtrar valores de salud > 0
datos_filtrados <- concentrado_2016_SEL %>% filter(salud > 0)
# Nuevo diseño con filtro aplicado
diseno_filtrado <- svydesign(ids = ~1, data = datos_filtrados, weights = ~factor)
# Estadísticas por grupo (decil)
svyby(
~salud,
~decil,
design = diseno_filtrado,
FUN = svymean,
keep.var = TRUE,
na.rm = TRUE
)
?svyby
library(srvyr)
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("readxl")
#install.packages("Hmisc")
#Do you want to install from sources the package which needs compilation? (Yes/no/cancel) no
#install.packages("survey")
#Do you want to install from sources the package which needs compilation? (Yes/no/cancel) no
install.packages("srvyr")
library(srvyr)
# Filtrar valores de salud > 0
datos_filtrados <- concentrado_2016_SEL %>% filter(salud > 0)
# Convertir a diseño compatible con dplyr
diseno_srvyr <- as_survey_design(datos_filtrados, weights = factor)
# Resumen por decil
resumen <- diseno_srvyr %>%
group_by(decil) %>%
summarize(
n = survey_total(!is.na(salud)),
suma = survey_total(salud),
media = survey_mean(salud),
sd = survey_sd(salud),
minimo = survey_quantile(salud, 0, ci = FALSE),
maximo = survey_quantile(salud, 1, ci = FALSE)
)
print(resumen)
names(resumen)
resumen
resumen[ c( "decil", "n", "suma", "media", "sd", "minimo_q00", "maximo_q100" )]
# Filtrar valores de salud > 0
datos_filtrados <- concentrado_2016_SEL %>% filter(salud > 0)
# Convertir a diseño compatible con dplyr
diseno_srvyr <- as_survey_design(datos_filtrados, weights = factor)
# Resumen por decil
resumen <- diseno_srvyr %>%
group_by(decil) %>%
summarize(
n = survey_total(!is.na(salud)),
suma = survey_total(salud),
media = survey_mean(salud),
sd = survey_sd(salud),
minimo = survey_quantile(salud, 0, ci = FALSE),
maximo = survey_quantile(salud, 1, ci = FALSE)
)
resumen
#resumen[ c( "decil", "n", "suma", "media", "sd", "minimo_q00", "maximo_q100" )]
decil_cortes
# Crear los puntos de corte (deciles)
decil_cortes <- wtd.quantile( concentrado_2016$ing_cor,
weights = concentrado_2016$factor,
probs = seq(0, 1, 0.1))
decil_cortes
# Filtrar valores de salud > 0
datos_filtrados <- concentrado_2016_SEL %>% filter(salud > 0)
# Convertir a diseño compatible con dplyr
diseno_srvyr <- as_survey_design(datos_filtrados, weights = factor)
# Resumen por decil
resumen <- diseno_srvyr %>%
group_by(decil) %>%
summarize(
n = survey_total(!is.na(salud)),
suma = survey_total(salud),
media = survey_mean(salud),
sd = survey_sd(salud),
minimo = survey_quantile(salud, 0, ci = FALSE),
maximo = survey_quantile(salud, 1, ci = FALSE)
)
#resumen
resumen[ c( "decil", "n", "suma", "media", "sd", "minimo_q00", "maximo_q100" )]
# Filtrar valores de salud > 0
datos_filtrados <- concentrado_2016_SEL %>% filter(salud > 0)
dim(datos_filtrados)
# Seleccionamos diversa información, icluído el gasto trimestral en cuidados de salud
concentrado_2016_SEL <- concentrado_2016[ c( 'folioviv', 'foliohog', 'factor', 'ing_cor', 'decil', 'gasto_mon', 'salud' ) ]
dim(concentrado_2016_SEL)
# Convertir a diseño compatible con dplyr
diseno_srvyr <- as_survey_design(datos_filtrados, weights = factor)
# Resumen por decil
resumen <- diseno_srvyr %>%
group_by(decil) %>%
summarize(
n = survey_total(!is.na(ing_cor)),
suma = survey_total(ing_cor),
media = survey_mean(ing_cor),
sd = survey_sd(ing_cor),
minimo = survey_quantile(ing_cor, 0, ci = FALSE),
maximo = survey_quantile(ing_cor, 1, ci = FALSE)
)
#resumen
resumen[ c( "decil", "n", "suma", "media", "sd", "minimo_q00", "maximo_q100" )]
650.8729 / 8382.502
3902.8181 / 182107.430
# Convertir a diseño compatible con dplyr
diseno_srvyr <- as_survey_design(datos_filtrados, weights = factor)
# Resumen por decil
resumen <- diseno_srvyr %>%
group_by(decil) %>%
summarize(
n = survey_total(!is.na(gasto_mon)),
suma = survey_total(gasto_mon),
media = survey_mean(gasto_mon),
sd = survey_sd(gasto_mon),
minimo = survey_quantile(gasto_mon, 0, ci = FALSE),
maximo = survey_quantile(gasto_mon, 1, ci = FALSE)
)
#resumen
resumen[ c( "decil", "n", "suma", "media", "sd", "minimo_q00", "maximo_q100" )]
# Convertir a diseño compatible con dplyr
diseno_srvyr <- as_survey_design(datos_filtrados, weights = factor)
# Resumen por decil
resumen <- diseno_srvyr %>%
group_by(decil) %>%
summarize(
n = survey_total(!is.na(ing_cor)),
suma = survey_total(ing_cor),
media = survey_mean(ing_cor),
sd = survey_sd(ing_cor),
minimo = survey_quantile(ing_cor, 0, ci = FALSE),
maximo = survey_quantile(ing_cor, 1, ci = FALSE)
)
#resumen
resumen[ c( "decil", "n", "suma", "media", "sd", "minimo_q00", "maximo_q100" )]
install.packages("writexl")
library(writexl)
# Guardar el dataframe en un archivo Excel
write_xlsx(concentrado_2016_SEL, "concentrado_2016_SEL.xlsx")
